---
import BaseLayout from '../layouts/BaseLayout.astro';
import ProcedureCard from '../components/ProcedureCard.astro';
import WhatsAppIcon from '../components/icons/WhatsAppIcon.astro';
import { siteConfig } from '../data/site';

// 5 "pillar" categories matching the Recafy catalog structure
const procedurePillars = [
  {
    title: 'Procedimientos Corporales',
    description: 'Liposucción Vaser, abdominoplastia, lipoescultura y más procedimientos para lograr la figura que deseas.',
    href: '/procedimientos-corporales/',
    image: '/images/site/cat-corporales.webp',
  },
  {
    title: 'Armonización Facial',
    description: 'Botox, rellenos faciales, hilos tensores, bioestimuladores, blefaroplastia y más tratamientos de rejuvenecimiento.',
    href: '/procedimientos-faciales/',
    image: '/images/site/cat-faciales.webp',
  },
  {
    title: 'Ginecoestética',
    description: 'Rejuvenecimiento íntimo con láser CO2, labioplastia, vaginoplastia y tratamientos de bienestar ginecológico.',
    href: '/procedimientos-intimos/',
    image: '/images/site/cat-intimos.webp',
  },
  {
    title: 'Bienestar Hormonal',
    description: 'Pellet de testosterona LifeChip para mejorar energía, bienestar y calidad de vida.',
    href: '/procedimientos-corporales/lifechip-testosterona/',
    image: '/images/procedures/lifechip-testosterona.webp',

  },
];

// Hero pillar quick-links (short labels for the hero banner)
const heroPillars = [
  { label: 'Procedimientos Corporales', href: '/procedimientos-corporales/' },
  { label: 'Armonización Facial', href: '/procedimientos-faciales/' },
  { label: 'Ginecoestética', href: '/procedimientos-intimos/' },
  { label: 'Bienestar Hormonal', href: '/procedimientos-corporales/lifechip-testosterona/' },
];

---

<BaseLayout
  title="Medicina Estética en Las Condes"
  description="Bendov Clínica Estética - Procedimientos y tratamientos estéticos en Las Condes, Santiago de Chile. Faciales, corporales, íntimos y hormonales."
>
  <!-- Hero -->
  <section class="relative overflow-hidden bg-primary-950 pt-32 pb-24 md:pt-44 md:pb-36">
    <!-- Background image -->
    <img
      src="/images/site/hero-bg.webp"
      alt=""
      class="absolute inset-0 h-full w-full object-cover opacity-40"
      loading="eager"
      decoding="async"
    />
    <div class="absolute inset-0 bg-gradient-to-br from-primary-950/60 via-primary-900/45 to-primary-800/30" />

    <div class="relative mx-auto max-w-6xl px-6">
      <div class="mx-auto max-w-3xl text-center">
        <p class="mb-4 text-sm font-semibold uppercase tracking-[0.2em] text-primary-300">
          Bendov Clínica Estética
        </p>
        <h1 class="font-display text-4xl font-bold leading-tight text-white md:text-6xl lg:text-7xl">
          Recupera tu
          <span class="text-primary-400">confianza</span>
        </h1>
        <p class="mx-auto mt-6 max-w-2xl text-lg leading-relaxed text-primary-200 md:text-xl">
          Nuestra misión es brindar los mejores procedimientos y atención médica
          especializada de primer nivel para mejorar su calidad de vida.
        </p>
        <div class="mt-10 flex flex-wrap items-center justify-center gap-3">
          {heroPillars.map((pillar) => (
            <a
              href={pillar.href}
              class="rounded-full border border-white/20 bg-white/5 px-5 py-2.5 text-sm font-medium text-white backdrop-blur-sm transition-all hover:border-white/40 hover:bg-white/10"
            >
              {pillar.label}
            </a>
          ))}
        </div>
      </div>
    </div>
  </section>

  <!-- Procedure Categories -->
  <section class="mx-auto max-w-6xl px-6 py-24">
    <div class="text-center">
      <p class="text-sm font-semibold uppercase tracking-[0.15em] text-primary-600">Nuestros Procedimientos</p>
      <h2 class="mt-2 font-display text-3xl font-bold text-neutral-950 md:text-4xl">
        Soluciones para cada necesidad
      </h2>
      <p class="mx-auto mt-4 max-w-2xl text-lg text-neutral-500">
        Ofrecemos una amplia gama de procedimientos estéticos realizados por especialistas certificados.
      </p>
    </div>

    <div class="mt-14 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {procedurePillars.map((pillar) => (
        <ProcedureCard
          title={pillar.title}
          href={pillar.href}
          description={pillar.description}
          image={pillar.image}
        />
      ))}
    </div>
  </section>

  <!-- About / Trust section -->
  <section class="bg-primary-950 py-24">
    <div class="mx-auto max-w-6xl px-6">
      <div class="mx-auto max-w-3xl text-center">
        <div>
          <p class="text-sm font-semibold uppercase tracking-[0.15em] text-primary-400">Sobre Nosotros</p>
          <h2 class="mt-2 font-display text-3xl font-bold text-white md:text-4xl">
            Más de dos décadas de experiencia en medicina estética
          </h2>
          <p class="mt-6 text-lg leading-relaxed text-primary-200">
            Somos una clínica de medicina estética dedicada a resolver diferentes
            necesidades de nuestros pacientes tanto mujeres como hombres. Nuestros
            principales procedimientos son Procedimientos Corporales, Armonización Facial,
            Ginecoestética, Aumento Mamario y Bienestar Hormonal.
          </p>
          <p class="mt-4 text-lg leading-relaxed text-primary-200">
            Confía tu belleza a los mejores. Te acompañamos de principio a fin con una
            atención personalizada y resultados que hablan por sí solos.
          </p>
          <a
            href="/sobre-nosotros/"
            class="mt-8 inline-flex items-center gap-2 rounded-full bg-primary-600 px-6 py-3 text-sm font-semibold text-white transition-colors hover:bg-primary-500"
          >
            Conoce más sobre nosotros
            <svg class="h-4 w-4" width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
            </svg>
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Google Reviews -->
  <section class="py-20 md:py-28">
    <div class="mx-auto max-w-6xl px-6">
      <div class="text-center">
        <p class="text-sm font-semibold uppercase tracking-[0.15em] text-primary-600">Experiencias Reales</p>
        <h2 class="mt-2 font-display text-3xl font-bold text-neutral-950 md:text-4xl">
          Lo que dicen nuestros pacientes
        </h2>
        <p class="mx-auto mt-4 max-w-2xl text-lg text-neutral-500">
          Reseñas verificadas de Google Maps de pacientes que confiaron en nosotros.
        </p>
      </div>

      <!-- Trustindex widget anchor — must be in the DOM before the loader runs -->
      <div class="trustindex-reviews mt-12" id="trustindex-container">
        <div data-trustindex-id="4721dc764ab986480346dfc4846"></div>
      </div>

      <!-- Fallback shown if widget fails to render after timeout -->
      <div id="trustindex-fallback" class="mt-8 hidden text-center">
        <a
          href="https://www.google.com/maps/place/Bendov+Cl%C3%ADnica+Est%C3%A9tica/@-33.4145,-70.5956,17z/"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 text-sm font-medium text-primary-600 transition-colors hover:text-primary-800"
        >
          <svg class="h-4 w-4" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
          </svg>
          Ver todas las reseñas en Google Maps
        </a>
      </div>

      <script>
        let tiLoaded = false;

        function loadTrustindex() {
          const container = document.getElementById('trustindex-container');
          const fallback = document.getElementById('trustindex-fallback');
          if (!container) return;

          // Reset state on each navigation
          tiLoaded = false;
          fallback?.classList.add('hidden');

          // Remove any previously injected widget/script but keep the anchor div
          container.querySelectorAll('script, .ti-widget').forEach(el => el.remove());

          // Restore anchor div in case it was replaced by the widget on prior load
          if (!container.querySelector('[data-trustindex-id]')) {
            const anchor = document.createElement('div');
            anchor.setAttribute('data-trustindex-id', '4721dc764ab986480346dfc4846');
            container.prepend(anchor);
          }

          // Inject loader
          const s = document.createElement('script');
          s.src = 'https://cdn.trustindex.io/loader.js?4721dc764ab986480346dfc4846';
          s.async = true;
          s.onload = () => { tiLoaded = true; };
          container.appendChild(s);

          // After 5 seconds, if no widget rendered, show fallback
          setTimeout(() => {
            if (!tiLoaded || !container.querySelector('.ti-widget')) {
              fallback?.classList.remove('hidden');
            }
          }, 5000);
        }

        document.addEventListener('astro:page-load', loadTrustindex);
      </script>
    </div>
  </section>

  <!-- CTA -->
  <section class="bg-primary-700 py-20">
    <div class="mx-auto max-w-4xl px-6 text-center">
      <h2 class="font-display text-3xl font-bold text-white md:text-4xl">
        Da el primer paso hacia tu mejor versión
      </h2>
      <p class="mt-4 text-lg text-primary-100">
        Agenda tu evaluación gratuita y sin compromiso. Nuestro equipo te guiará
        hacia el procedimiento ideal para ti.
      </p>
      <div class="mt-8 flex flex-col items-center justify-center gap-4 sm:flex-row">
        <a
          href={siteConfig.contact.schedulingUrl}
          target="_blank"
          rel="noopener noreferrer"
          data-gtm="cta-scheduling"
          data-gtm-location="homepage-bottom-cta"
          class="inline-flex items-center gap-2 rounded-full bg-white px-8 py-4 text-base font-semibold text-primary-700 shadow-lg transition-all hover:scale-105 hover:shadow-xl"
        >
          <svg class="h-5 w-5" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" />
          </svg>
          Agenda tu Evaluación
        </a>
        <a
          href={siteConfig.contact.whatsappHref}
          target="_blank"
          rel="noopener noreferrer"
          data-gtm="cta-whatsapp"
          data-gtm-location="homepage-bottom-cta"
          class="inline-flex items-center gap-2 rounded-full border-2 border-white/30 px-8 py-4 text-base font-semibold text-white transition-all hover:border-white/50 hover:bg-white/10"
        >
          <WhatsAppIcon class="h-5 w-5" />
          Escríbenos por WhatsApp
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
